import{j as e,a1 as S,k as P,N as E,V as F,a2 as I,a3 as D}from"./ui-Dqq999Tl.js";import{r as x}from"./vendor-6qmzlMN_.js";import{B as N,C as h,a as j,b as p,c as u,L as c,I as d,S as b}from"./index-DJlXE8rz.js";function V({onBack:g,selectedClass:n,selectedPackage:s,onSuccess:w,user:a}){const[r,m]=x.useState({name:(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",phone:""});x.useEffect(()=>{a&&m({name:a.name||"",email:a.email||"",phone:""})},[a]);const[f,y]=x.useState(!1),[v,o]=x.useState(null),C=async()=>{if(!(!r.name||!r.email)){y(!0),o(null);try{const i={studentName:r.name,studentEmail:r.email,studentPhone:r.phone,amount:n?11:s?s.price:0,classDetails:n,packageDetails:s};console.log("Creating payment intent with data:",i);const t=await b.createPaymentIntent(i);if(!t)throw new Error("Failed to create payment intent");console.log("Payment intent created, client secret:",t),console.log("Processing payment...");try{await b.processPayment(t,l=>{console.log("Payment succeeded:",l),w()},l=>{console.error("Payment failed:",l),o(l)}),console.log("Payment processing completed")}catch(l){console.error("Error in payment processing:",l),o("Payment processing failed: "+((l==null?void 0:l.message)||"Unknown error"))}}catch(i){o(i.message||"Payment failed. Please try again.")}finally{y(!1)}}};return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:g,className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"Back"]}),e.jsx("h1",{className:"text-2xl font-heading",children:"Secure Payment"})]}),e.jsxs(h,{className:"mb-6",children:[e.jsx(j,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Payment Method"]})}),e.jsx(u,{children:e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"font-semibold text-green-800",children:"Secure Payment with Stripe"})]}),e.jsx("p",{className:"text-green-700 text-sm",children:"Your payment is processed securely by Stripe. We accept all major credit cards, debit cards, and digital wallets."}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs text-green-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),e.jsx("span",{children:"Bank-level security"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:"PCI compliant"})]})]})]})})]}),e.jsxs(h,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(p,{children:"Order Summary"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:n?"Single Class":s==null?void 0:s.name}),e.jsxs("span",{className:"font-bold",children:["$",n?"11.00":s?s.price.toFixed(2):"0.00"]})]}),n&&e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Class:"})," ",n.className]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Teacher:"})," ",n.teacher]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",n.day]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",n.time]})]}),s&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Package Type:"})," ",s.type==="five"?"5-Class Package":"10-Class Package"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Classes Included:"})," ",s.type==="five"?"5":"10"]})]}),e.jsxs("div",{className:"border-t pt-3 mt-3",children:[e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",n?"11.00":s?s.price.toFixed(2):"0.00"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"* Processing fees included in total"})]})]})})]}),e.jsxs(h,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(p,{children:"Student Information"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"studentName",children:"Full Name *"}),e.jsx(d,{id:"studentName",value:r.name,onChange:i=>m(t=>({...t,name:i.target.value})),placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"studentEmail",children:"Email Address *"}),e.jsx(d,{id:"studentEmail",type:"email",value:r.email,onChange:i=>m(t=>({...t,email:i.target.value})),placeholder:"Enter your email address",required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"studentPhone",children:"Phone Number"}),e.jsx(d,{id:"studentPhone",value:r.phone,onChange:i=>m(t=>({...t,phone:i.target.value})),placeholder:"Enter your phone number"})]})]})})]}),e.jsxs(h,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(p,{children:"Payment Information"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"cardNumber",children:"Card Number *"}),e.jsx(d,{id:"cardNumber",placeholder:"1234 5678 9012 3456",className:"font-mono"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"We accept Visa, Mastercard, Discover, and American Express"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"expiryDate",children:"Expiry Date *"}),e.jsx(d,{id:"expiryDate",placeholder:"MM/YY",className:"font-mono"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"cvv",children:"CVV *"}),e.jsx(d,{id:"cvv",placeholder:"123",className:"font-mono",maxLength:4})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"billingZip",children:"Billing ZIP Code *"}),e.jsx(d,{id:"billingZip",placeholder:"12345",className:"font-mono",maxLength:10})]})]})})]}),v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-700 text-sm",children:v})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(N,{onClick:g,variant:"outline",className:"flex-1",children:"Cancel"}),e.jsx(N,{onClick:C,disabled:f||!r.name||!r.email,className:"flex-1",children:f?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):`Pay $${n?"11.00":s?s.price.toFixed(2):"0.00"}`})]})]})})})}export{V as StripePaymentPage};
